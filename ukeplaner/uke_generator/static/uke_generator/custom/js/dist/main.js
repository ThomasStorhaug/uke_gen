(()=>{"use strict";class e{constructor(e){this.course_data=e,this.course="",this.course_is_chosen=!1,this.available_subjects=this.course_data["Fellesfag vg1"],this.teachers={};for(let e of this.available_subjects)this.teachers[e]="";this.schedule=[];for(let e=0;e<5;e++){var t=[];for(let e=0;e<8;e++)t.push({teacher:"",subject:"",room:"",color:"",double:!1});this.schedule.push(t)}this.prepared_period={day:"",period:""}}prepare_period(e,t){this.prepared_period.day=e,this.prepared_period.period=t}set_course(e){this.course=e,this.set_available_subjects(e),this.set_teachers(),this.course_is_chosen||(this.course_is_chosen=!0)}set_available_subjects(e){this.available_subjects=this.course_data["Fellesfag vg1"].concat(this.course_data[e])}set_teachers(){let e={};for(let t in this.teachers)this.available_subjects.includes(t)?e[t]=this.teachers[t]:e[t]="";this.teachers=e}set_teacher(e,t){this.available_subjects.includes(e)?this.teachers[e]=t:console.log("Error: Trying to set a teacher in a subject not in course!")}get_available_subjects(){return this.available_subjects}set_period(e,t,s){this.schedule[e][t]=s}get_period(e,t){return this.schedule[e][t]}get_schedule(){return this.schedule}}$(document).ready((function(){const t=new e(course_subjects);function s(e,s){t.set_teacher(e,s),console.log(t.teachers)}function a(e){t.set_course(e),function(){const e=t.get_available_subjects(),a=$("#teacher-container");a.empty();for(let t of e){var r=$("<div></div>").addClass("input-group"),o=$("<input></input>").addClass("form-control").attr("id",`#teacher-input-${t}`);o.change((function(){$(`#teacher-input${t}`).removeClass("is-valid")}));let e=$("<label></label>").attr("for",`teacher-input-${t}`).text(t),l=$("<button></button>").addClass("btn btn-outline-secondary").attr("type","button").attr("id",`add-teacher-to${t}`).click((function(){$(`#teacher-input-${t}`).addClass("is-valid");let e=$(`#teacher-input-${t}`).val();s(t,e)})).text("Legg til");r.append(o).append(l),a.append(e).append(r)}}()}var r=document.getElementById("course-select");r.addEventListener("change",(function(){a(r.options[r.selectedIndex].value)})),document.getElementById("modal_update_schedule_btn").addEventListener("click",(function(){let e=document.getElementById("modal-active-period").value;!function(e,s,a){let r=document.getElementById("modal_room_input").value,o=document.querySelector("input[name='modal_subject_select']:checked");if(o)var l=o.value;else l="";var d={teacher:t.teachers[l],subject:l,room:r};t.set_period(e,s,d);let i=t.get_period(e,s),c=[i.subject,i.room,i.teacher],n="";for(let e of c)e&&(n=n.concat(`${e}\n`));let u=document.getElementById(`btn-p${s}-d${e}`),h=u.parentElement;u.innerText=n;let p=h.parentElement;a&&p.classList.contains("schedule-preview__first-row")&&(h.setAttribute("rowspan","2"),h.classList.remove("schedule-preview__period--first"),h.classList.add("schedule-preview__period--double"),document.getElementById(`td-p${s+1}-d${e}`).remove())}(Number(e.substr(4,1)),Number(e.substr(1,1)),document.getElementById("period-is-double").checked)})),window.set_selected_course=a,window.prepare_modal=function(e,s){const a=$("#modal-course-container");t.prepare_period(s,e);const r=t.get_available_subjects(),o=t.get_period(s,e);if(a.empty(),t.course_is_chosen)$("#period-is-double").removeAttr("disabled"),$("#modal-room-input").removeAttr("disabled"),$("#modal-update-schedule-btn").removeAttr("disabled"),$("#modal-alert")&&$("#modal-alert").remove();else{$("#period-is-double").attr("disabled"),$("#modal-room-input").attr("disabled"),$("#modal-update-schedule-btn").attr("disabled");let e=$("<div></div>").addClass("alert alert-danger").attr("role","alert").attr("id","modal-alert").text("Du må velge linje først!");$("#modal-double-eriod-form").before(e)}for(let e of r){let s=$("<input>");s.attr({type:"radio",id:`modal-subject-${e}`,name:"modal-subject-select",value:e}).addClass("btn-check"),e==o.subject&&s.attr("checked");let r=$("<label></label>").attr("for",`modal_-subject-${e}`).addClass("btn").text(e);a.append(s).append(r),t.course_is_chosen||s.attr("disabled")}}}))})();